package kaoqin.packa;

import java.io.*;
import org.apache.poi.hssf.usermodel.*;
import java.util.*;

public class madeexcel {
    public void copyFile(String oldPath, String newPath) {
        try {
            //int  bytesum  =  0;
            int byteread = 0;
            File oldfile = new File(oldPath);
            if (oldfile.exists()) { //文件存在时
                InputStream inStream = new FileInputStream(oldPath); //读入原文件
                FileOutputStream fs = new FileOutputStream(newPath);
                byte[] buffer = new byte[1024];
                while ((byteread = inStream.read(buffer)) != -1) {
                    //bytesum  +=  byteread;  //字节数  文件大小
                    fs.write(buffer, 0, byteread);
                }
                inStream.close();
                fs.close();
            }
        } catch (Exception e) {
            System.out.println("复制单个文件操作出错");
            e.printStackTrace();
        }
    }

    public void getexcel(String subject_id, String filename) throws IOException {
        sumdb db = new sumdb();
        memberdb db1 = new memberdb();
        budgetdb db2 = new budgetdb();
        ListIterator iter1 = null;
        ListIterator iter2 = null;
        iter1 = db1.getmember(subject_id).listIterator();
        iter2 = db2.getbudget(subject_id).listIterator();
        ArrayList iterlist = (ArrayList) db.getonesum(subject_id);
        sumdetail book = (sumdetail) iterlist.get(0);
        String templet1=book.getTemplet();
        
    try {
        HSSFWorkbook workbook = new HSSFWorkbook(new FileInputStream(filename));
        HSSFSheet sheet = workbook.getSheetAt(0);

        HSSFRow row = sheet.getRow((short) 2);
        HSSFCell cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getInstitute_num());
        row = sheet.getRow((short) 3);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getNoinstitute_num());
        row = sheet.getRow((short) 4);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getIproject_num());
        row = sheet.getRow((short) 5);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getProject_num());
        row = sheet.getRow((short) 6);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getSubject_name());
        row = sheet.getRow((short) 7);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getSubject_num());
        row = sheet.getRow((short) 8);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getSub_num());
        row = sheet.getRow((short) 9);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getLinkman());
        row = sheet.getRow((short) 10);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getEmail());

        row = sheet.getRow((short) 12);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getProject_name());
        row = sheet.getRow((short) 13);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getPro_num());
        row = sheet.getRow((short) 14);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getTotal());
        row = sheet.getRow((short) 15);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getFunds());
        row = sheet.getRow((short) 16);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getHead());
        row = sheet.getRow((short) 17);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getPeriod());
        row = sheet.getRow((short) 18);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getCo_school());
        row = sheet.getRow((short) 19);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getCo_country());
        row = sheet.getRow((short) 20);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getDepartment());
        row = sheet.getRow((short) 21);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getGrade());
        row = sheet.getRow((short) 22);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getSource());
        row = sheet.getRow((short) 23);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getConsigned());
        row = sheet.getRow((short) 24);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getType());
        row = sheet.getRow((short) 25);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getKnowledge());
        row = sheet.getRow((short) 26);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getField());
        row = sheet.getRow((short) 27);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getObjective());
        row = sheet.getRow((short) 28);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getTrade());
        row = sheet.getRow((short) 29);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getCooperation());
        row = sheet.getRow((short) 30);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getProgress());
        row = sheet.getRow((short) 31);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getReason());
        row = sheet.getRow((short) 32);
        cell = row.getCell((short) 2);
        cell.setEncoding(HSSFCell.ENCODING_UTF_16);
        cell.setCellValue(book.getSubject_money());
        
        sheet = workbook.getSheetAt(1);
        int i=1;
        HSSFRow sourceRow = sheet.getRow((short) 1);
        HSSFCell sourceCell = sourceRow.getCell((short) 0);
        for (; iter1.hasNext(); ) {
              memberdetail book1 = (memberdetail) iter1.next();
              row = sheet.createRow((short) i);
              row.setHeight(sourceRow.getHeight());
              cell = row.createCell((short) 0);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue(book1.getMember_name());
              cell = row.createCell((short) 1);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue(book1.getClass_name1());
              cell = row.createCell((short) 2);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue(book1.getClass_name2());
              cell = row.createCell((short) 3);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue(book1.getBegin_date());
              cell = row.createCell((short) 4);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue(book1.getRemark());
              i++;
        }
        
        sheet = workbook.getSheetAt(2);
        i=1;
        if(templet1==null){
        	
        }else if(templet1.equals("0")){
        	row = sheet.createRow((short) 0);
            row.setHeight(sourceRow.getHeight());
            cell = row.createCell((short) 0);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("年份");
            cell = row.createCell((short) 1);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("购置设备费");
            cell = row.createCell((short) 2);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("试制设备费");
            cell = row.createCell((short) 3);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("设备改造与租赁费");
            cell = row.createCell((short) 4);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("材料费");
            cell = row.createCell((short) 5);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("测试化验加工费");
            cell = row.createCell((short) 6);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("燃料动力费");
            cell = row.createCell((short) 7);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("差旅费");
            cell = row.createCell((short) 8);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("会议费");
            cell = row.createCell((short) 9);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("国际合作与交流费");
            cell = row.createCell((short) 10);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("出版/文献/信息传播/知识产权事务费");
            cell = row.createCell((short) 11);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("劳务费");
            cell = row.createCell((short) 12);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("专家咨询费");
            cell = row.createCell((short) 13);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("管理费");
            cell = row.createCell((short) 14);
            cell.setEncoding(HSSFCell.ENCODING_UTF_16);
            cell.setCellStyle(sourceCell.getCellStyle());
            cell.setCellType(sourceCell.getCellType());
            cell.setCellValue("转拨经费");
            
            for (; iter2.hasNext(); ) {
                budgetdetail book2 = (budgetdetail) iter2.next();
                row = sheet.createRow((short) i);
                row.setHeight(sourceRow.getHeight());
                cell = row.createCell((short) 0);
                cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                cell.setCellStyle(sourceCell.getCellStyle());
                cell.setCellType(sourceCell.getCellType());
                cell.setCellValue(book2.getBudget_year());
                
              	    cell = row.createCell((short) 1);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getDevice1().equals("0"))cell.setCellValue(book2.getDevice1());
                    cell = row.createCell((short) 2);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getDevice2().equals("0"))cell.setCellValue(book2.getDevice2());
                    cell = row.createCell((short) 3);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getDevice3().equals("0"))cell.setCellValue(book2.getDevice3());
                    cell = row.createCell((short) 4);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getMaterial().equals("0"))cell.setCellValue(book2.getMaterial());
                    cell = row.createCell((short) 5);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getExperiment().equals("0"))cell.setCellValue(book2.getExperiment());
                    cell = row.createCell((short) 6);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getPower().equals("0"))cell.setCellValue(book2.getPower());
                    cell = row.createCell((short) 7);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getTravel().equals("0"))cell.setCellValue(book2.getTravel());
                    cell = row.createCell((short) 8);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getMeeting().equals("0"))cell.setCellValue(book2.getMeeting());
                    cell = row.createCell((short) 9);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getInternational().equals("0"))cell.setCellValue(book2.getInternational());
                    cell = row.createCell((short) 10);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getPublish().equals("0"))cell.setCellValue(book2.getPublish());
                    cell = row.createCell((short) 11);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getLabour().equals("0"))cell.setCellValue(book2.getLabour());
                    cell = row.createCell((short) 12);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getExpert().equals("0"))cell.setCellValue(book2.getExpert());
                    cell = row.createCell((short) 13);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getManage().equals("0"))cell.setCellValue(book2.getManage());
                    cell = row.createCell((short) 14);
                    cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                    cell.setCellStyle(sourceCell.getCellStyle());
                    cell.setCellType(sourceCell.getCellType());
                    if(!book2.getTransfer().equals("0"))cell.setCellValue(book2.getTransfer());
                i++;
              }
          }else if(templet1.equals("1")){
        	  row = sheet.createRow((short) 0);
              row.setHeight(sourceRow.getHeight());
              cell = row.createCell((short) 0);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue("年份");
              cell = row.createCell((short) 1);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue("购置设备费");
            	  cell = row.createCell((short) 2);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("研制设备费");
                  cell = row.createCell((short) 3);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("设备改造与租赁费");
                  cell = row.createCell((short) 4);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("材料费");
                  cell = row.createCell((short) 5);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("测试化验加工及计算分析费");
                  cell = row.createCell((short) 6);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("差旅费");
                  cell = row.createCell((short) 7);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("燃料动力费");
                  cell = row.createCell((short) 8);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("会议费");
                  cell = row.createCell((short) 9);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("国际合作与交流费");
                  cell = row.createCell((short) 10);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("出版/文献/信息传播/知识产权事务费");
                  cell = row.createCell((short) 11);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("专家咨询费");
                  cell = row.createCell((short) 12);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("劳务费");
                  cell = row.createCell((short) 13);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("管理费");
                  cell = row.createCell((short) 14);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("综合集成与调控费");
                  cell = row.createCell((short) 15);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("转拨经费");
                  
        	  for (; iter2.hasNext(); ) {
                  budgetdetail book2 = (budgetdetail) iter2.next();
                  row = sheet.createRow((short) i);
                  row.setHeight(sourceRow.getHeight());
                  cell = row.createCell((short) 0);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue(book2.getBudget_year());
                  
                  
                	  cell = row.createCell((short) 1);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice1().equals("0"))cell.setCellValue(book2.getDevice1());
                      cell = row.createCell((short) 2);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice2().equals("0"))cell.setCellValue(book2.getDevice2());
                      cell = row.createCell((short) 3);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice3().equals("0"))cell.setCellValue(book2.getDevice3());
                      cell = row.createCell((short) 4);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMaterial().equals("0"))cell.setCellValue(book2.getMaterial());
                      cell = row.createCell((short) 5);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExperiment().equals("0"))cell.setCellValue(book2.getExperiment());
                      cell = row.createCell((short) 6);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTravel().equals("0"))cell.setCellValue(book2.getTravel());
                      cell = row.createCell((short) 7);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPower().equals("0"))cell.setCellValue(book2.getPower());
                      cell = row.createCell((short) 8);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMeeting().equals("0"))cell.setCellValue(book2.getMeeting());
                      cell = row.createCell((short) 9);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getInternational().equals("0"))cell.setCellValue(book2.getInternational());
                      cell = row.createCell((short) 10);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPublish().equals("0"))cell.setCellValue(book2.getPublish());
                      cell = row.createCell((short) 11);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExpert().equals("0"))cell.setCellValue(book2.getExpert());
                      cell = row.createCell((short) 12);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getLabour().equals("0"))cell.setCellValue(book2.getLabour());
                      cell = row.createCell((short) 13);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getManage().equals("0"))cell.setCellValue(book2.getManage());
                      cell = row.createCell((short) 14);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMulti().equals("0"))cell.setCellValue(book2.getMulti());
                      cell = row.createCell((short) 15);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTransfer().equals("0"))cell.setCellValue(book2.getTransfer());                      
                  i++;
                }
          }else if(templet1.equals("2")){
        	  row = sheet.createRow((short) 0);
              row.setHeight(sourceRow.getHeight());
              cell = row.createCell((short) 0);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue("年份");
              
            	  cell = row.createCell((short) 1);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("购置设备费");
                  cell = row.createCell((short) 2);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("试制设备费");
                  cell = row.createCell((short) 3);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("设备改造与租赁费");
                  cell = row.createCell((short) 4);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("材料费");
                  cell = row.createCell((short) 5);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("测试化验加工费");
                  cell = row.createCell((short) 6);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("燃料动力费");
                  cell = row.createCell((short) 7);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("差旅费");
                  cell = row.createCell((short) 8);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("会议费");
                  cell = row.createCell((short) 9);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("国际合作与交流费");
                  cell = row.createCell((short) 10);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("出版/文献/信息传播/知识产权事务费");
                  cell = row.createCell((short) 11);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("劳务费");
                  cell = row.createCell((short) 12);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("专家咨询费");
                  cell = row.createCell((short) 13);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("绩效支出");
                  cell = row.createCell((short) 14);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("其他间接费用");
                  cell = row.createCell((short) 15);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("转拨经费");
                  
        	  for (; iter2.hasNext(); ) {
                  budgetdetail book2 = (budgetdetail) iter2.next();
                  row = sheet.createRow((short) i);
                  row.setHeight(sourceRow.getHeight());
                  cell = row.createCell((short) 0);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue(book2.getBudget_year());
                  
                  
                	  cell = row.createCell((short) 1);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice1().equals("0"))cell.setCellValue(book2.getDevice1());
                      cell = row.createCell((short) 2);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice2().equals("0"))cell.setCellValue(book2.getDevice2());
                      cell = row.createCell((short) 3);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice3().equals("0"))cell.setCellValue(book2.getDevice3());
                      cell = row.createCell((short) 4);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMaterial().equals("0"))cell.setCellValue(book2.getMaterial());
                      cell = row.createCell((short) 5);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExperiment().equals("0"))cell.setCellValue(book2.getExperiment());
                      cell = row.createCell((short) 6);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPower().equals("0"))cell.setCellValue(book2.getPower());
                      cell = row.createCell((short) 7);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTravel().equals("0"))cell.setCellValue(book2.getTravel());
                      cell = row.createCell((short) 8);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMeeting().equals("0"))cell.setCellValue(book2.getMeeting());
                      cell = row.createCell((short) 9);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getInternational().equals("0"))cell.setCellValue(book2.getInternational());
                      cell = row.createCell((short) 10);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPublish().equals("0"))cell.setCellValue(book2.getPublish());
                      cell = row.createCell((short) 11);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getLabour().equals("0"))cell.setCellValue(book2.getLabour());
                      cell = row.createCell((short) 12);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExpert().equals("0"))cell.setCellValue(book2.getExpert());
                      cell = row.createCell((short) 13);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getJixiao().equals("0"))cell.setCellValue(book2.getJixiao());
                      cell = row.createCell((short) 14);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getOther1().equals("0"))cell.setCellValue(book2.getOther1());
                      cell = row.createCell((short) 15);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTransfer().equals("0"))cell.setCellValue(book2.getTransfer());                      
                  i++;
                }
          }else if(templet1.equals("3")){
        	  row = sheet.createRow((short) 0);
              row.setHeight(sourceRow.getHeight());
              cell = row.createCell((short) 0);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue("年份");
              
            	  cell = row.createCell((short) 1);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("测试/计算/分析费");
                  cell = row.createCell((short) 2);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("能源/动力费");
                  cell = row.createCell((short) 3);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("会议费/差旅费");
                  cell = row.createCell((short) 4);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("出版物/文献/信息传播事务费");
                  cell = row.createCell((short) 5);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("其他科研业务费");
                  cell = row.createCell((short) 6);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("原材料/试剂/药品购置费");
                  cell = row.createCell((short) 7);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("其他试验材料费");
                  cell = row.createCell((short) 8);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("仪器设备费");
                  cell = row.createCell((short) 9);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("实验室改造费");
                  cell = row.createCell((short) 10);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("协作费");
                  cell = row.createCell((short) 11);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("项目组成员出国合作交流");
                  cell = row.createCell((short) 12);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("境外专家来华合作交流");
                  cell = row.createCell((short) 13);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("劳务费");
                  cell = row.createCell((short) 14);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("管理费");
                  cell = row.createCell((short) 15);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("转拨经费");
                  
        	  for (; iter2.hasNext(); ) {
                  budgetdetail book2 = (budgetdetail) iter2.next();
                  row = sheet.createRow((short) i);
                  row.setHeight(sourceRow.getHeight());
                  cell = row.createCell((short) 0);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue(book2.getBudget_year());
                  
                  
                	  cell = row.createCell((short) 1);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExperiment().equals("0"))cell.setCellValue(book2.getExperiment());
                      cell = row.createCell((short) 2);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPower().equals("0"))cell.setCellValue(book2.getPower());
                      cell = row.createCell((short) 3);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMeeting().equals("0"))cell.setCellValue(book2.getMeeting());
                      cell = row.createCell((short) 4);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPublish().equals("0"))cell.setCellValue(book2.getPublish());
                      cell = row.createCell((short) 5);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getOther1().equals("0"))cell.setCellValue(book2.getOther1());
                      cell = row.createCell((short) 6);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMaterial().equals("0"))cell.setCellValue(book2.getMaterial());
                      cell = row.createCell((short) 7);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getOther2().equals("0"))cell.setCellValue(book2.getOther2());
                      cell = row.createCell((short) 8);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice1().equals("0"))cell.setCellValue(book2.getDevice1());
                      cell = row.createCell((short) 9);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice2().equals("0"))cell.setCellValue(book2.getDevice2());
                      cell = row.createCell((short) 10);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getCooperate().equals("0"))cell.setCellValue(book2.getCooperate());
                      cell = row.createCell((short) 11);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getInternational().equals("0"))cell.setCellValue(book2.getInternational());
                      cell = row.createCell((short) 12);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExpert().equals("0"))cell.setCellValue(book2.getExpert());
                      cell = row.createCell((short) 13);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getLabour().equals("0"))cell.setCellValue(book2.getLabour());
                      cell = row.createCell((short) 14);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getManage().equals("0"))cell.setCellValue(book2.getManage());
                      cell = row.createCell((short) 15);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTransfer().equals("0"))cell.setCellValue(book2.getTransfer());                      
                  i++;
                }
          }else if(templet1.equals("4")){
        	  row = sheet.createRow((short) 0);
              row.setHeight(sourceRow.getHeight());
              cell = row.createCell((short) 0);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue("年份");
              
            	  cell = row.createCell((short) 1);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("设备费");
                  cell = row.createCell((short) 2);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("材料费");
                  cell = row.createCell((short) 3);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("测试化验加工费");
                  cell = row.createCell((short) 4);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("燃料动力费");
                  cell = row.createCell((short) 5);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("差旅费");
                  cell = row.createCell((short) 6);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("会议费");
                  cell = row.createCell((short) 7);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("国际合作与交流费");
                  cell = row.createCell((short) 8);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("出版/文献/信息传播/知识产权事务费");
                  cell = row.createCell((short) 9);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("劳务费");
                  cell = row.createCell((short) 10);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("专家咨询费");
                  cell = row.createCell((short) 11);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("基本建设费-房屋建筑物购建");
                  cell = row.createCell((short) 12);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("基本建设费-专用设备购置");
                  cell = row.createCell((short) 13);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("基本建设费-基本设施建设");
                  cell = row.createCell((short) 14);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("基本建设费-大型修缮");
                  cell = row.createCell((short) 15);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("基本建设费-信息网络建设");
                  cell = row.createCell((short) 16);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("基本建设费-其他基本建设支出");
                  cell = row.createCell((short) 17);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("其他-间接费用");
                  cell = row.createCell((short) 18);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("其他-不可预见费");
                  cell = row.createCell((short) 19);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("中间试验（制）费");
                  cell = row.createCell((short) 20);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("转拨经费");
                  
        	  for (; iter2.hasNext(); ) {
                  budgetdetail book2 = (budgetdetail) iter2.next();
                  row = sheet.createRow((short) i);
                  row.setHeight(sourceRow.getHeight());
                  cell = row.createCell((short) 0);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue(book2.getBudget_year());
                  
                  
                	  cell = row.createCell((short) 1);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice1().equals("0"))cell.setCellValue(book2.getDevice1());
                      cell = row.createCell((short) 2);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTransfer().equals("0"))cell.setCellValue(book2.getTransfer());
                      cell = row.createCell((short) 3);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExperiment().equals("0"))cell.setCellValue(book2.getExperiment());
                      cell = row.createCell((short) 4);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPower().equals("0"))cell.setCellValue(book2.getPower());
                      cell = row.createCell((short) 5);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTravel().equals("0"))cell.setCellValue(book2.getTravel());
                      cell = row.createCell((short) 6);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMeeting().equals("0"))cell.setCellValue(book2.getMeeting());
                      cell = row.createCell((short) 7);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getInternational().equals("0"))cell.setCellValue(book2.getInternational());
                      cell = row.createCell((short) 8);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPublish().equals("0"))cell.setCellValue(book2.getPublish());
                      cell = row.createCell((short) 9);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getLabour().equals("0"))cell.setCellValue(book2.getLabour());
                      cell = row.createCell((short) 10);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExpert().equals("0"))cell.setCellValue(book2.getExpert());
                      cell = row.createCell((short) 11);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getBase1().equals("0"))cell.setCellValue(book2.getBase1());
                      cell = row.createCell((short) 12);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getBase2().equals("0"))cell.setCellValue(book2.getBase2());
                      cell = row.createCell((short) 13);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getBase3().equals("0"))cell.setCellValue(book2.getBase3());
                      cell = row.createCell((short) 14);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getBase4().equals("0"))cell.setCellValue(book2.getBase4());
                      cell = row.createCell((short) 15);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getBase5().equals("0"))cell.setCellValue(book2.getBase5()); 
                      cell = row.createCell((short) 16);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getBase6().equals("0"))cell.setCellValue(book2.getBase6()); 
                      cell = row.createCell((short) 17);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getOther1().equals("0"))cell.setCellValue(book2.getOther1());
                      cell = row.createCell((short) 18);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getOther2().equals("0"))cell.setCellValue(book2.getOther2());
                      cell = row.createCell((short) 19);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice2().equals("0"))cell.setCellValue(book2.getDevice2());
                      cell = row.createCell((short) 20);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTransfer().equals("0"))cell.setCellValue(book2.getTransfer());
                      
                  i++;
                }
          }else if(templet1.equals("5")){
        	  row = sheet.createRow((short) 0);
              row.setHeight(sourceRow.getHeight());
              cell = row.createCell((short) 0);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue("年份");
              
            	  cell = row.createCell((short) 1);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("设备费");
                  cell = row.createCell((short) 2);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("材料费");
                  cell = row.createCell((short) 3);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("测试化验加工及计算分析费");
                  cell = row.createCell((short) 4);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("燃料动力费");
                  cell = row.createCell((short) 5);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("差旅费");
                  cell = row.createCell((short) 6);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("会议费");
                  cell = row.createCell((short) 7);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("国际合作与交流费");
                  cell = row.createCell((short) 8);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("出版/文献/信息传播/知识产权事务费");
                  cell = row.createCell((short) 9);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("专家咨询费");
                  cell = row.createCell((short) 10);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("劳务费");
                  cell = row.createCell((short) 11);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("管理费");
                  cell = row.createCell((short) 12);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("转拨经费");
                  
        	  for (; iter2.hasNext(); ) {
                  budgetdetail book2 = (budgetdetail) iter2.next();
                  row = sheet.createRow((short) i);
                  row.setHeight(sourceRow.getHeight());
                  cell = row.createCell((short) 0);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue(book2.getBudget_year());
                  
                  
                	  cell = row.createCell((short) 1);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice1().equals("0"))cell.setCellValue(book2.getDevice1());
                      cell = row.createCell((short) 2);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMaterial().equals("0"))cell.setCellValue(book2.getMaterial());
                      cell = row.createCell((short) 3);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExperiment().equals("0"))cell.setCellValue(book2.getExperiment());
                      cell = row.createCell((short) 4);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPower().equals("0"))cell.setCellValue(book2.getPower());
                      cell = row.createCell((short) 5);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTravel().equals("0"))cell.setCellValue(book2.getTravel());
                      cell = row.createCell((short) 6);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMeeting().equals("0"))cell.setCellValue(book2.getMeeting());
                      cell = row.createCell((short) 7);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getInternational().equals("0"))cell.setCellValue(book2.getInternational());
                      cell = row.createCell((short) 8);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPublish().equals("0"))cell.setCellValue(book2.getPublish());
                      cell = row.createCell((short) 9);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExpert().equals("0"))cell.setCellValue(book2.getExpert());
                      cell = row.createCell((short) 10);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getLabour().equals("0"))cell.setCellValue(book2.getLabour());
                      cell = row.createCell((short) 11);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getManage().equals("0"))cell.setCellValue(book2.getManage());
                      cell = row.createCell((short) 12);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTransfer().equals("0"))cell.setCellValue(book2.getTransfer());
                                       
                  i++;
                }
          }else if(templet1.equals("6")){
        	  row = sheet.createRow((short) 0);
              row.setHeight(sourceRow.getHeight());
              cell = row.createCell((short) 0);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue("年份");
              
            	  cell = row.createCell((short) 1);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("购置设备费");
                  cell = row.createCell((short) 2);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("设备费");
                  cell = row.createCell((short) 3);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("材料费");
                  cell = row.createCell((short) 4);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("测试化验加工费");
                  cell = row.createCell((short) 5);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("燃料动力费");
                  cell = row.createCell((short) 6);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("差旅费");
                  cell = row.createCell((short) 7);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("会议费");
                  cell = row.createCell((short) 8);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("国际合作与交流费");
                  cell = row.createCell((short) 9);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("出版/文献/信息传播/知识产权事务费");
                  cell = row.createCell((short) 10);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("专家咨询费");
                  cell = row.createCell((short) 11);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("人员劳务费");
                  cell = row.createCell((short) 12);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("管理费");
                  cell = row.createCell((short) 13);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("其他费");
                  cell = row.createCell((short) 14);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("转拨经费");
                  
        	  for (; iter2.hasNext(); ) {
                  budgetdetail book2 = (budgetdetail) iter2.next();
                  row = sheet.createRow((short) i);
                  row.setHeight(sourceRow.getHeight());
                  cell = row.createCell((short) 0);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue(book2.getBudget_year());
                  
                	  cell = row.createCell((short) 1);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice1().equals("0"))cell.setCellValue(book2.getDevice1());
                      cell = row.createCell((short) 2);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice2().equals("0"))cell.setCellValue(book2.getDevice2());
                      cell = row.createCell((short) 3);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMaterial().equals("0"))cell.setCellValue(book2.getMaterial());
                      cell = row.createCell((short) 4);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExperiment().equals("0"))cell.setCellValue(book2.getExperiment());
                      cell = row.createCell((short) 5);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPower().equals("0"))cell.setCellValue(book2.getPower());
                      cell = row.createCell((short) 6);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTravel().equals("0"))cell.setCellValue(book2.getTravel());
                      cell = row.createCell((short) 7);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMeeting().equals("0"))cell.setCellValue(book2.getMeeting());
                      cell = row.createCell((short) 8);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getInternational().equals("0"))cell.setCellValue(book2.getInternational());
                      cell = row.createCell((short) 9);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPublish().equals("0"))cell.setCellValue(book2.getPublish());
                      cell = row.createCell((short) 10);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExpert().equals("0"))cell.setCellValue(book2.getExpert());                      
                      cell = row.createCell((short) 11);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getLabour().equals("0"))cell.setCellValue(book2.getLabour());
                      cell = row.createCell((short) 12);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getManage().equals("0"))cell.setCellValue(book2.getManage());
                      cell = row.createCell((short) 13);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getOther1().equals("0"))cell.setCellValue(book2.getOther1());
                      cell = row.createCell((short) 14);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTransfer().equals("0"))cell.setCellValue(book2.getTransfer());
                                        
                  i++;
                }
          }else if(templet1.equals("7")){
        	  row = sheet.createRow((short) 0);
              row.setHeight(sourceRow.getHeight());
              cell = row.createCell((short) 0);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue("年份");
              
            	  cell = row.createCell((short) 1);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("购置设备费");
                  cell = row.createCell((short) 2);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("试制设备费");
                  cell = row.createCell((short) 3);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("设备改造与租赁费");
                  cell = row.createCell((short) 4);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("材料费");
                  cell = row.createCell((short) 5);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("测试化验加工费");
                  cell = row.createCell((short) 6);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("燃料动力费");
                  cell = row.createCell((short) 7);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("差旅费");
                  cell = row.createCell((short) 8);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("会议费");
                  cell = row.createCell((short) 9);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("国际合作与交流费");
                  cell = row.createCell((short) 10);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("出版/文献/信息传播/知识产权事务费");
                  cell = row.createCell((short) 11);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("劳务费");
                  cell = row.createCell((short) 12);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("专家咨询费");
                  cell = row.createCell((short) 13);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("管理费");
                  cell = row.createCell((short) 14);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("其他费");
                  cell = row.createCell((short) 15);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("转拨经费");
                  
        	  for (; iter2.hasNext(); ) {
                  budgetdetail book2 = (budgetdetail) iter2.next();
                  row = sheet.createRow((short) i);
                  row.setHeight(sourceRow.getHeight());
                  cell = row.createCell((short) 0);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue(book2.getBudget_year());
                  
                  
                	  cell = row.createCell((short) 1);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice1().equals("0"))cell.setCellValue(book2.getDevice1());
                      cell = row.createCell((short) 2);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice2().equals("0"))cell.setCellValue(book2.getDevice2());
                      cell = row.createCell((short) 3);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice3().equals("0"))cell.setCellValue(book2.getDevice3());
                      cell = row.createCell((short) 4);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMaterial().equals("0"))cell.setCellValue(book2.getMaterial());
                      cell = row.createCell((short) 5);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExperiment().equals("0"))cell.setCellValue(book2.getExperiment());
                      cell = row.createCell((short) 6);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPower().equals("0"))cell.setCellValue(book2.getPower());
                      cell = row.createCell((short) 7);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTravel().equals("0"))cell.setCellValue(book2.getTravel());
                      cell = row.createCell((short) 8);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMeeting().equals("0"))cell.setCellValue(book2.getMeeting());
                      cell = row.createCell((short) 9);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getInternational().equals("0"))cell.setCellValue(book2.getInternational());
                      cell = row.createCell((short) 10);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPublish().equals("0"))cell.setCellValue(book2.getPublish());
                      cell = row.createCell((short) 11);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getLabour().equals("0"))cell.setCellValue(book2.getLabour());
                      cell = row.createCell((short) 12);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExpert().equals("0"))cell.setCellValue(book2.getExpert());
                      cell = row.createCell((short) 13);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getManage().equals("0"))cell.setCellValue(book2.getManage());
                      cell = row.createCell((short) 14);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getOther1().equals("0"))cell.setCellValue(book2.getOther1());
                      cell = row.createCell((short) 15);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTransfer().equals("0"))cell.setCellValue(book2.getTransfer());                      
                  i++;
                }
          }else if(templet1.equals("8")){
        	  row = sheet.createRow((short) 0);
              row.setHeight(sourceRow.getHeight());
              cell = row.createCell((short) 0);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue("年份");
              
            	  cell = row.createCell((short) 1);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("设备购置费");
                  cell = row.createCell((short) 2);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("设备试制费");
                  cell = row.createCell((short) 3);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("设备改造与租赁费");
                  cell = row.createCell((short) 4);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("材料费");
                  cell = row.createCell((short) 5);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("测试化验加工费");
                  cell = row.createCell((short) 6);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("燃料动力费");
                  cell = row.createCell((short) 7);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("差旅费");
                  cell = row.createCell((short) 8);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("会议费");
                  cell = row.createCell((short) 9);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("国际合作与交流费");
                  cell = row.createCell((short) 10);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("出版/文献/信息传播/知识产权事务费");
                  cell = row.createCell((short) 11);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("劳务费");
                  cell = row.createCell((short) 12);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("专家咨询费");
                  cell = row.createCell((short) 13);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("其他支出");
                  
        	  for (; iter2.hasNext(); ) {
                  budgetdetail book2 = (budgetdetail) iter2.next();
                  row = sheet.createRow((short) i);
                  row.setHeight(sourceRow.getHeight());
                  cell = row.createCell((short) 0);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue(book2.getBudget_year());
                  
                  
                	  cell = row.createCell((short) 1);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice1().equals("0"))cell.setCellValue(book2.getDevice1());
                      cell = row.createCell((short) 2);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice2().equals("0"))cell.setCellValue(book2.getDevice2());
                      cell = row.createCell((short) 3);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice3().equals("0"))cell.setCellValue(book2.getDevice3());
                      cell = row.createCell((short) 4);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMaterial().equals("0"))cell.setCellValue(book2.getMaterial());
                      cell = row.createCell((short) 5);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExperiment().equals("0"))cell.setCellValue(book2.getExperiment());
                      cell = row.createCell((short) 6);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPower().equals("0"))cell.setCellValue(book2.getPower());
                      cell = row.createCell((short) 7);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTravel().equals("0"))cell.setCellValue(book2.getTravel());
                      cell = row.createCell((short) 8);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMeeting().equals("0"))cell.setCellValue(book2.getMeeting());
                      cell = row.createCell((short) 9);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getInternational().equals("0"))cell.setCellValue(book2.getInternational());
                      cell = row.createCell((short) 10);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPublish().equals("0"))cell.setCellValue(book2.getPublish());
                      cell = row.createCell((short) 11);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getLabour().equals("0"))cell.setCellValue(book2.getLabour());
                      cell = row.createCell((short) 12);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExpert().equals("0"))cell.setCellValue(book2.getExpert());
                      cell = row.createCell((short) 13);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getOther1().equals("0"))cell.setCellValue(book2.getOther1());
                                        
                  i++;
                }
          }else if(templet1.equals("9")){
        	  row = sheet.createRow((short) 0);
              row.setHeight(sourceRow.getHeight());
              cell = row.createCell((short) 0);
              cell.setEncoding(HSSFCell.ENCODING_UTF_16);
              cell.setCellStyle(sourceCell.getCellStyle());
              cell.setCellType(sourceCell.getCellType());
              cell.setCellValue("年份");
              
            	  cell = row.createCell((short) 1);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("购置设备费");
                  cell = row.createCell((short) 2);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("试制设备费");
                  cell = row.createCell((short) 3);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("设备改造与租赁费");
                  cell = row.createCell((short) 4);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("材料费");
                  cell = row.createCell((short) 5);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("测试化验加工费");
                  cell = row.createCell((short) 6);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("燃料动力费");
                  cell = row.createCell((short) 7);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("差旅费/会议费/国际合作与交流费");
                  cell = row.createCell((short) 8);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("出版/文献/信息传播/知识产权事务费");
                  cell = row.createCell((short) 9);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("劳务费");
                  cell = row.createCell((short) 10);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("专家咨询费");
                  cell = row.createCell((short) 11);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("其他支出");
                  cell = row.createCell((short) 12);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("间接费用");
                  cell = row.createCell((short) 13);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue("转出经费");
                  
        	  for (; iter2.hasNext(); ) {
                  budgetdetail book2 = (budgetdetail) iter2.next();
                  row = sheet.createRow((short) i);
                  row.setHeight(sourceRow.getHeight());
                  cell = row.createCell((short) 0);
                  cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                  cell.setCellStyle(sourceCell.getCellStyle());
                  cell.setCellType(sourceCell.getCellType());
                  cell.setCellValue(book2.getBudget_year());
                  
                  
                	  cell = row.createCell((short) 1);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice1().equals("0"))cell.setCellValue(book2.getDevice1());
                      cell = row.createCell((short) 2);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice2().equals("0"))cell.setCellValue(book2.getDevice2());
                      cell = row.createCell((short) 3);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getDevice3().equals("0"))cell.setCellValue(book2.getDevice3());
                      cell = row.createCell((short) 4);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMaterial().equals("0"))cell.setCellValue(book2.getMaterial());
                      cell = row.createCell((short) 5);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExperiment().equals("0"))cell.setCellValue(book2.getExperiment());
                      cell = row.createCell((short) 6);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPower().equals("0"))cell.setCellValue(book2.getPower());
                      cell = row.createCell((short) 7);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getTravel().equals("0"))cell.setCellValue(book2.getTravel());
                      cell = row.createCell((short) 8);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getMeeting().equals("0"))cell.setCellValue(book2.getPublish());
                      cell = row.createCell((short) 9);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getInternational().equals("0"))cell.setCellValue(book2.getLabour());
                      cell = row.createCell((short) 10);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getPublish().equals("0"))cell.setCellValue(book2.getExpert());
                      cell = row.createCell((short) 11);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getLabour().equals("0"))cell.setCellValue(book2.getOther2());
                      cell = row.createCell((short) 12);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getExpert().equals("0"))cell.setCellValue(book2.getOther1());
                      cell = row.createCell((short) 13);
                      cell.setEncoding(HSSFCell.ENCODING_UTF_16);
                      cell.setCellStyle(sourceCell.getCellStyle());
                      cell.setCellType(sourceCell.getCellType());
                      if(!book2.getManage().equals("0"))cell.setCellValue(book2.getTransfer());
                                           
                  i++;
                }
          }
            FileOutputStream fOut = new FileOutputStream(filename);
            workbook.write(fOut);
            fOut.flush();
            fOut.close();
        } catch (Exception e) {
            System.out.print(e);
        }
    }

    public void getsumexcel(String querystatement, String filename) throws IOException {
       sumdb db = new sumdb();
       ListIterator iter = null;
       iter = db.getOutQuerysum(querystatement).listIterator();

   try {
       HSSFWorkbook workbook = new HSSFWorkbook(new FileInputStream(filename));
       HSSFSheet sheet = workbook.getSheetAt(0);
       HSSFRow row;
       HSSFCell cell;
       HSSFRow sourceRow = sheet.getRow((short) 1);
       HSSFCell sourceCell = sourceRow.getCell((short) 0);
       int i=1;
       for (; iter.hasNext(); ) {
           sumdetail2 book = (sumdetail2) iter.next();
           row = sheet.createRow((short) i);
           row.setHeight(sourceRow.getHeight());
           cell = row.createCell((short) 0);
           cell.setEncoding(HSSFCell.ENCODING_UTF_16);
           cell.setCellStyle(sourceCell.getCellStyle());
           cell.setCellValue(book.getDepartment());
           cell = row.createCell((short) 1);
           cell.setEncoding(HSSFCell.ENCODING_UTF_16);
           cell.setCellStyle(sourceCell.getCellStyle());
           cell.setCellValue(book.getInstitute_num());
           cell = row.createCell((short) 2);
           cell.setEncoding(HSSFCell.ENCODING_UTF_16);
           cell.setCellStyle(sourceCell.getCellStyle());
           cell.setCellValue(book.getNoinstitute_num());
           cell = row.createCell((short) 3);
           cell.setEncoding(HSSFCell.ENCODING_UTF_16);
           cell.setCellStyle(sourceCell.getCellStyle());
           cell.setCellValue(book.getPro_num());
           cell = row.createCell((short) 4);
           cell.setEncoding(HSSFCell.ENCODING_UTF_16);
           cell.setCellStyle(sourceCell.getCellStyle());
           cell.setCellValue(book.getTotal());
           cell = row.createCell((short) 5);
           cell.setEncoding(HSSFCell.ENCODING_UTF_16);
           cell.setCellStyle(sourceCell.getCellStyle());
           cell.setCellValue(book.getFunds());
           cell = row.createCell((short) 6);
           cell.setEncoding(HSSFCell.ENCODING_UTF_16);
           cell.setCellStyle(sourceCell.getCellStyle());
           cell.setCellValue(book.getProject_num());
           cell = row.createCell((short) 7);
           cell.setEncoding(HSSFCell.ENCODING_UTF_16);
           cell.setCellStyle(sourceCell.getCellStyle());
           cell.setCellValue(book.getSubject_num());
           cell = row.createCell((short) 8);
           cell.setEncoding(HSSFCell.ENCODING_UTF_16);
           cell.setCellStyle(sourceCell.getCellStyle());
           cell.setCellValue(book.getSubject_name());
           cell = row.createCell((short) 9);
           cell.setEncoding(HSSFCell.ENCODING_UTF_16);
           cell.setCellStyle(sourceCell.getCellStyle());
           cell.setCellValue(book.getSub_num());
           cell = row.createCell((short) 10);
           cell.setEncoding(HSSFCell.ENCODING_UTF_16);
           cell.setCellStyle(sourceCell.getCellStyle());
           cell.setCellValue(book.getHead());
           cell = row.createCell((short) 11);
           cell.setEncoding(HSSFCell.ENCODING_UTF_16);
           cell.setCellStyle(sourceCell.getCellStyle());
           cell.setCellValue(book.getPeriod());
           cell = row.createCell((short) 12);
           cell.setEncoding(HSSFCell.ENCODING_UTF_16);
           cell.setCellStyle(sourceCell.getCellStyle());
           cell.setCellValue(book.getSource());
           i++;
       }
           FileOutputStream fOut = new FileOutputStream(filename);
           workbook.write(fOut);
           fOut.flush();
           fOut.close();
       } catch (Exception e) {
           System.out.print(e);
       }
   }
}
